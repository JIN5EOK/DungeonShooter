# 개요
> 아이템, 스킬, 몬스터 등 데이터 테이블에 대한 설계입니다

* 대량의 수치 기반 데이터를 ID기반 테이블로 관리
* 프리펩, 에디터의 기능을 많이 사용해야 하는 부분들은 스크립터블 오브젝트 등으로 관리
* 리포지토리 패턴으로 데이터를 제공하고 제공하는 방식은 인터페이스로 감춤

# 다이어그램

## ITableEntry와 TableRepository
```mermaid
classDiagram
    class ITableRepository["ITableRepository<br>테이블 데이터 제공"]{
	    +GetTableEntry~T~(int id) UniTask~T~ where T : ITableEntry
	}
	
	class LocalTableRepository["LocalTableRepository<br>로컬 CSV 파일로 데이터 제공"]{

	}
	
	class RemoteTableRepository["RemoteTableRepository<br>원격으로 데이터 제공"]{
        // 구현예정, 아직 미구현
	}
	
	class CSVTableParser["CSVTableParser<br>CSV 파싱 로직"]{
	    Parse~List~T~~(TextAssets textAsset) 
	    // T는 TableEntry
    }
	
	class ITableEntry["ITableEntry<br>TableEntry의 공통 인터페이스"]{
	    +Id : int
    }
	
	ITableEntry <|.. SkillTableEntry
    ITableEntry <|.. ItemTableEntry
    ITableEntry <|.. StageConfigTableEntry
	ITableEntry "0..*"<--"1" ITableRepository
	ITableRepository <|.. LocalTableRepository
	ITableRepository <|.. RemoteTableRepository
    LocalTableRepository --> CSVTableParser
    사용자 --> ITableRepository : ID와 타입을 지정해 TableEntry 요청
```

* `ITableRepository`
    * `LocalTableRepository`
      * 어드레서블을 통해 CSV 파일을 TextAsset 형태로 가져옴
      * `CSVTableParser`를 통해 로컬 CSV 데이터를 기반으로 파싱된 `ITableEntry`들을 제공받은후 캐싱
    * `ITableRepository`는 `GlobalLifeTimeScope`에서 게임을 시작하자마자 초기화, 게임 내내 들고 있도록 함
        * 추후 데이터가 매우 많아질 경우 최적화 전략 필요할수도 있으나 일단은 이렇게 해도 충분할것으로 보임
* `CSVTableParser`
    * 기본 CSV 파일 생성 (MenuItem 사용, 에디터 전용 기능)
        * `SkillTableEntry`, `ItemTableEntry`들을 생성하는데 필요한 정보를 담을 수 있는 기본 CSV파일 생성
        * 1행에 변수 이름을 담고 2행부터 데이터를 담을 수 있도록 비워두기
    * CSV 파일에서 데이터를 읽어 `SkillTableEntry`, `ItemTableEntry` 등으로 역직렬화
        * 변환할 때 기본적으로 1:1 변환, int Id라면 Id 열의 값을 담으면 됨
        * `SkillTableEntry.IntAmounts`, `SkillTableEntry.FloatAmounts` 의 경우 문자열 키 : 값 형태의 값을 담음, 각 요소들은 '/'로 구분
          * 예: -> IntAmounts 열에 두가지 값을 담으려면 "myIntAmount1:10/myIntAmount2:10" 로 표현
          * 파싱할때 이 문자열을 파싱하여 각각 IntAmounts, FloatAmounts 딕셔너리에 삽입