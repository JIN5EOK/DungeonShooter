# 개요
> 아이템과 인벤토리 시스템 전반에 대한 설계 문서입니다

# 아이템, 인벤토리 기능
* 인벤토리 스펙
    * 장착 아이템 슬롯
        * 1개의 무기 슬롯
	        * 공격력을 비롯한 스텟 ()
            * 일반공격 스킬과 필살기 스킬
				* 예시 - 장창, 일반공격 - 찌르기, 필살기 - 돌진공격
    * 인벤토리 영역
        * 아이템들이 저장되는 공간
        * 액티브 아이템, 무기, 소비 아이템이 저장된다
* 아이템들의 고유 특징
    * 무기
	    * 무기 슬롯에 장착 가능
	        * 해제하기 위해서는 다른 무기를 장착해야 한다
		* 공격버튼, 필살기 버튼을 눌러 공격할 수 있다
    * 패시브
        * 소지하면 지속적으로 효과가 부여된다
	* 소비
		* 인벤토리에서 사용하면 효과가 실행된다

# 다이어그램

### 인벤토리와 아이템 인스턴스 관계도
```mermaid
classDiagram
    class ConsumeItemData["ConsumeItemData : ScriptableObject<br>소비 아이템 고정 데이터"]{
        -consumeEffect : SkillData // 사용 효과
    }
    
    class PassiveItemData["PassiveItemData : ScriptableObject<br>패시브 아이템 고정 데이터"]{
        -passiveEffect : SkillData // 소지 효과
    }
    
    class WeaponItemData["WeaponItemData : ScriptableObject<br>무기 아이템 고정 데이터"]{
        -skillEffect : SkillData // 공격 효과
        -speciallSkillEffect : SkillData // 필살기 효과
        -equipEffect : SkillData // 장착 효과
    }
    
    class ItemData["ItemData<br>아이템 고정 데이터"]{
        <<abstract>>
        +ItemName : string
        +ItemDescription : string
        +MaxStackCount : int
    }
    
	class ItemBase["ItemBase<br>인벤토리의 아이템 인스턴스"]{
        <<abstract>>
        +StackCount : int
    }

    class Inventory["Inventory<br>장착/소지 아이템 관리 인벤토리"]{
        -equippedWeapon : Item
        +Items : IReadonlyList~Item~
        +AddItem(ItemBase item) void
        +EquipItem(ItemBase item) void
    }

	class WeaponItem["WeaponItem<br>인벤토리의 무기 아이템 인스턴스"]{
		-itemData : WeaponItemData
		-additionalEquipEffect : List~EffectBase~ 
		// 기본효과에 더해지는 추가 소지 효과
	}
	class PassiveItem["PassiveItem<br>인벤토리의 패시브 아이템 인스턴스"]{
		-itemData : PassiveItemData
		-additionalPassiveEffect : List~EffectBase~ 
		// 기본효과에 더해지는 추가 소지 효과
	}
	class ConsumeItem["ConsumeItem<br>인벤토리의 소모 아이템 인스턴스"]{
		-itemData : ConsumeItemData
	}

	Inventory "1" -- "0..*" ItemBase

    ItemBase <|-- PassiveItem
    ItemBase <|-- ConsumeItem
    ItemBase <|-- WeaponItem
    PassiveItem --> PassiveItemData
    ConsumeItem --> ConsumeItemData
    WeaponItem --> WeaponItemData
    
    PassiveItemData --|> ItemData
    ConsumeItemData --|> ItemData
    WeaponItemData --|> ItemData
```

* `Inventory`는 캐릭터 게임오브젝트에 귀속되어야 하는 정보가 아니므로 `EntityComponent`로 사용하지 않음, (플레이어블 캐릭터가 교체되거나 해도 인벤토리는 유지)
* 스테이지 씬에 진입시 `StageLifeTimeScope`에서 `Scoped` 형태로 생성한 후 주입해 사용하고 스테이지 씬에서 벗어날 경우 해제
### 필드 아이템 (드롭 아이템) 상호작용 구조
```mermaid
classDiagram
    Player --> "Interact(획득)" IInteractable
    IInteractable <|.. FieldItem
    Inventory <-- "AddItem(인벤토리에 아이템 추가)" FieldItem

    class Inventory["Inventory<br>장착/소지 아이템 관리 인벤토리"]{
        +AddItem(itemBase) void
    }

    class IInteractable["IInteractable<br>상호작용 인터페이스"]{
        +Interact() void
    }

    class FieldItem["FieldItem<br>드랍된 필드 아이템"]{
        +itemBase : itemBase
        +Interact() void
    }
```