# 개요
> Entity가 사용하는 스킬 시스템 전반에 대한 설계 문서입니다.

---

## 스킬 시스템 구조
```mermaid
classDiagram
    class EffectBase["EffectBase<br>실행할 이펙트"]{
        <<abstract>>
        +Execute(EntityBase owner, target) bool
    }
    
    class SkillData["SkillData<br>스킬 효과 리스트와 기타 정보"]{
        <<ScriptableObject>>
        + Cooldown : float
		+ IsPassiveSkill : bool // 패시브 이펙트 갯수 > 0
		+ IsActiveSkill : bool // 액티브 이펙트 갯수 > 0
        + SkillEffects : List~EffectBase~
    }

    class ISkill["ISkill<br>스킬 인스턴스"]{
        +skillData : SkillData
        +IsCooldown : bool
        +Cooldown : float
        +OnExecute : event Action
        +OnCooldownChanged : Action~float~
        +OnCooldownEnded : Action
        +Execute(EntityBase owner, target) bool
    }

    class SkillComponent["SkillComponent<br>Entity의 스킬 컴포넌트"]{
        -skills : List~ISkill~
        +UseSkill(string skillKey) bool // ISkill.Execute 호출
        +RegistSkill(string skillKey) bool // SkillData를 불러와 ISkill 생성 
        +UnRegistSkill(string skillKey) bool
    }
    SkillData <-- ISkill : 스킬 데이터 참조
    EffectBase "0..*"--"1" SkillData
    SkillComponent --> ISkill  : ISkill 통해 스킬 사용
```
- SkillData 스크립터블 오브젝트를 통해 스킬 효과를 작성한다
- 사용자는 Skill 인스턴스를 통해 실제로 스킬을 사용한다
### 스킬 이펙트들
```mermaid
classDiagram
    class EffectBase["EffectBase<br>실행할 이펙트"]{
        <<abstract>>
        +Execute(EntityBase owner, target) bool
    }

    class DamageEffect["DamageEffect<br>데미지"]{
        +Damage : int
    }

    class HealEffect["HealEffect<br>치료"]{
        +HealAmount : int
    }

    class SpawnProjectileEffect["SpawnProjectileEffect<br>투사체 소환"]{
        +projectile : AssetReferenceT~Projectile~ // 투사체 인스턴스 레퍼런스
        +effects : List~EffectBase~ // 투사체 적중시 효과
    }
    
    class Projectile["Projectile : Monobehaviour<br>투사체 인스턴스 프리팹"]{
        -owner : EntityBase // 소유자
        -effects : List~EffectBase~ // 투사체 적중시 효과
        -speed : float // 전진속도
        -lifeTime : float // 유지시간
        -triggerStartTime : float // 충돌 가능 시작시간
        -triggerEndTime : float // 충돌 가능 종료시간
        -destroyOnTrigger : bool // 충돌시 파괴 여부
        -applyToOppenent : bool // 상대방에게 충돌 가능 여부
        -applyToFriend : bool // 아군에게 충돌 가능 여부
    }

    EffectBase <|-- HealEffect
    EffectBase <|-- DamageEffect
    EffectBase <|-- SpawnProjectileEffect
    Projectile <-- SpawnProjectileEffect : 생성 및 이펙트 전달
```

# 임시작성
* `Skill`을 `PassiveSkill`과 `ActiveSkill`로 분리
	* 뭐가 필요한지
		* 액티브 스킬
			* 실행하면 효과 실행
			* 쿨다운
		* 패시브 스킬
			* 등록 즉시 효과 발동
			* 해제하면 효과 제거
* SkillData의 기능을 확장하기
	* 패시브 Effect 리스트
	* IsPassiveSkill 패시브 이펙트가 0개라면 패시브 스킬 아님
	* 액티브 Effect 리스트
	* IsActiveSkill 액티브 이펙트가 0개라면 액티브 스킬 아님
* Skill도 마찬가지로 확장
	* 스킬컴포넌트에 추가/제거시 패시브 스킬 활성화/비활성화
	* 액티브 스킬 사용 가능
* SkillComponent 수정
	* 스킬 컴포넌트 추가시 패시브 효과 적용
* EffectBase는 다음 역할을 수행
			* Exexute : 스킬 사용
			* Activate : 스킬 활성화 (스킬 컴포넌트 등록시 실행, 패시브 효과 추가)
			* Deactivate : 스킬 비활성화 (스킬 컴포넌트 등록시 실행, 패시브 효과 제거)

